

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Synchronisation of the Startkladde Database with a Webserver &mdash; python-startkladde 0.8.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="python-startkladde 0.8.0 documentation" href="../index.html"/>
        <link rel="up" title="Startkladde Backup" href="startkladde_restore.html"/>
        <link rel="next" title="startkladde_sync_master.bsh" href="startkladde_sync_master.html"/>
        <link rel="prev" title="Startkladde Backup" href="startkladde_restore.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> python-startkladde
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="executables.html">Executables of the python startkladde</a></li>
<li class="toctree-l1"><a class="reference internal" href="executables.html#python-scripts">Python Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sk.html">sk.py</a><ul>
<li class="toctree-l3"><a class="reference internal" href="sk_help.html">help</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sk_help.html#synopsis">Synopsis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sk_import-flights.html">import-flights</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sk_import-flights.html#synopsis">Synopsis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sk_stats.html">stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="sk_stats.html#synopsis">Synopsis</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sk.html#synopsis">Synopsis</a></li>
<li class="toctree-l3"><a class="reference internal" href="sk.html#display-statistics">Display statistics</a></li>
<li class="toctree-l3"><a class="reference internal" href="sk.html#set-email-adress-for-pilots">Set Email Adress for Pilots</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="executables.html#bash-scripts">Bash Scripts</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="startkladde_backup.html">startkladde_backup.bsh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="startkladde_backup.html#functionality">Functionality</a></li>
<li class="toctree-l3"><a class="reference internal" href="startkladde_backup.html#synopsis">Synopsis</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="startkladde_restore.html">startkladde_restore.bsh</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">Synchronisation of the Startkladde Database with a Webserver</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l4"><a class="reference internal" href="#master-configuration">Master Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#server-configuration">Server Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#backup-process">Backup Process</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="startkladde_sync_master.html">startkladde_sync_master.bsh</a><ul>
<li class="toctree-l3"><a class="reference internal" href="startkladde_sync_master.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="startkladde_sync_master.html#synopsis">Synopsis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules/pysk.html">The pysk package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/db/db.html">The db package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/db/model/model.html">Database Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/db/model/model.html#tables">Tables</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/db/database.html">Database Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/db/database.html#interface">Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/db/table.html">Table Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../modules/db/column.html">Column Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/db/column.html#interface">Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/db/csv_reader.html">CSV Reader Class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/db/csv_reader.html#expected-format">Expected Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/db/csv_reader.html#interface">Interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../modules/db/conflict_handler.html">Conflict Handler</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../modules/db/conflict_handler.html#interface">Interface</a></li>
<li class="toctree-l4"><a class="reference internal" href="../modules/db/conflict_handler.html#constants">Constants</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/tools/tools.html">Tools package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/tools/tool_base.html">Tool Base Class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../modules/utils/utils.html">Utils package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../modules/utils/ascii.html">ASCII Replacements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../github.html">GitHub Related Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../github.html#software-development">Software Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../github.html#getting-the-source-code">Getting the source code</a></li>
<li class="toctree-l3"><a class="reference internal" href="../github.html#workflow">Workflow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../github.html#publishing-documentation-with-github-project-pages">Publishing Documentation with GitHub Project Pages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../github.html#setting-up-the-branch">Setting Up the Branch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../github.html#disabling-jekyll">Disabling Jekyll</a></li>
<li class="toctree-l3"><a class="reference internal" href="../github.html#creating-and-publishing-documentation">Creating and Publishing Documentation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">python-startkladde</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="executables.html">Executables of the python startkladde</a> &raquo;</li>
      
          <li><a href="startkladde_restore.html">Startkladde Backup</a> &raquo;</li>
      
    <li>Synchronisation of the Startkladde Database with a Webserver</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/binaries/server_sync.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="synchronisation-of-the-startkladde-database-with-a-webserver">
<h1><a class="toc-backref" href="#id1">Synchronisation of the Startkladde Database with a Webserver</a><a class="headerlink" href="#synchronisation-of-the-startkladde-database-with-a-webserver" title="Permalink to this headline">¶</a></h1>
<p>This page desribes the synchronisation of a publicly accessible webserver
running the Startkladde Webinterface with a master device running the Startkladde
executable program.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#synchronisation-of-the-startkladde-database-with-a-webserver" id="id1">Synchronisation of the Startkladde Database with a Webserver</a><ul>
<li><a class="reference internal" href="#overview" id="id2">Overview</a></li>
<li><a class="reference internal" href="#master-configuration" id="id3">Master Configuration</a><ul>
<li><a class="reference internal" href="#the-flight-account" id="id4">The <em>flight</em> Account</a></li>
<li><a class="reference internal" href="#the-account-admin" id="id5">The Account <em>admin</em></a></li>
</ul>
</li>
<li><a class="reference internal" href="#server-configuration" id="id6">Server Configuration</a></li>
<li><a class="reference internal" href="#backup-process" id="id7">Backup Process</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id2">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This page describes the synchronisation of the main startkladde database with a
webserver for decentralised access to the flight database. It is assumed, that
a single master database exists on a device, which is used to log flights at
the airfield (the <em>master</em>). Additionally a web server (the <em>server</em>) with a
copy of the master database exists, which runs the Startkladde webinterface. The
goal is to export the master database to the server database.</p>
</div>
<div class="section" id="master-configuration">
<h2><a class="toc-backref" href="#id3">Master Configuration</a><a class="headerlink" href="#master-configuration" title="Permalink to this headline">¶</a></h2>
<p>The master is a linux system with the following accounts:</p>
<ul class="simple">
<li><em>flight</em>: account used for running the Startkladde executable</li>
<li><em>admin</em>: account for database &amp; backup administration (not the same as root)
This account should be used to execute the backup and synchronisation scripts.</li>
<li><em>root</em>: account for system administration</li>
</ul>
<p>The mysql database on the master has two accounts:</p>
<ul class="simple">
<li><em>startkladde</em> is the functional account used by the startkladde program</li>
<li><em>backup</em> has some additional rights needed to perform backup operations
on the database.</li>
</ul>
<div class="section" id="the-flight-account">
<h3><a class="toc-backref" href="#id4">The <em>flight</em> Account</a><a class="headerlink" href="#the-flight-account" title="Permalink to this headline">¶</a></h3>
<p>The <em>flight</em> account is intended as general access acount which is used to run
startkladde. Since this account is basically open to the public, the rights
of this account should be restricted to a minimum. It should e.g. not have read
access to any scripts containing passwords in clear text or any sensitive ssh
key files.</p>
</div>
<div class="section" id="the-account-admin">
<h3><a class="toc-backref" href="#id5">The Account <em>admin</em></a><a class="headerlink" href="#the-account-admin" title="Permalink to this headline">¶</a></h3>
<p>The admin account is the owner of all scripts for sync and should have more
rights in terms of database administration. The <em>admin</em> account must be
configured to act as an ssh client with passwordless login.</p>
</div>
</div>
<div class="section" id="server-configuration">
<h2><a class="toc-backref" href="#id6">Server Configuration</a><a class="headerlink" href="#server-configuration" title="Permalink to this headline">¶</a></h2>
<p>The server has a dedicated account <em>sync</em> for the synchronisation.</p>
</div>
<div class="section" id="backup-process">
<h2><a class="toc-backref" href="#id7">Backup Process</a><a class="headerlink" href="#backup-process" title="Permalink to this headline">¶</a></h2>
<p>The backup follows the following sequence:</p>
<ol class="arabic simple">
<li><em>flight</em> executes the
<a class="reference internal" href="startkladde_sync_master.html"><em>startkladde_sync_master.bsh</em></a> script on the
master. Since the script belongs to <em>admin</em>, the right to execute this script
as <em>admin</em> must be granted to flight using
<a class="reference external" href="http://www.sudo.ws/man/1.8.13/visudo.man.html">visudo</a></li>
<li>The startkladde_backup script is run by admin to create a backup file, which
is transferred to the server using scp. Scp performs password-less login on
the server using RSA. For this to work a public / private key pair has to
exist in /home/admin/.ssh. The public key id_rsa.pub must be made availabe to
the server.</li>
<li>The server must be configured to allow password-less login via ssh. This
requires to add the public key of the client to
/home/sync/.ssh/authorized_keys on the server. The respective line in
authorized_keys should have the form (without any newlines):
command=&#8221;&lt;path to startkladde_sync_server.sh&gt;&#8221;,no-port-forwarding,
no-X11-forwarding,no-agent-forwarding,no-pty,&lt;pub-key&gt;
This automatically executes the sync_server script and exits and thus permits
minimal possibilities for attackers.</li>
<li>The sync_server script copies the backup file using scp, performs a backup of
the current database using startkladde_backup and then restores the database
using startkladde_restore with the backup file copied from the client.</li>
</ol>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="startkladde_sync_master.html" class="btn btn-neutral float-right" title="startkladde_sync_master.bsh" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="startkladde_restore.html" class="btn btn-neutral" title="Startkladde Backup" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Claas H. Köhler.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.8.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>